A = [0.000000,3.17271;
0.000145,0.195251;
0.000291,0.121439;
0.000436,0.0890128;
0.000582,0.0421077;
0.000727,0.0343756;
0.000873,0.0324886;
0.001018,0.00476128;
0.001164,0.00669847;
0.001309,0.0177519;
0.001454,0.00231566;
0.001600,0.0147429;
0.001745,0.00111029;
0.001891,0.00112635;
0.002036,0.00303501;
0.002182,0.000497583;
0.002327,0.000587658;
0.002473,0.000809383;
0.002618,0.000294825;
0.002763,0.000378099;
0.002909,0.000222942;
0.003054,0.000176676;
0.003200,0.000128007;
0.003345,9.71015e-05;
0.003491,6.85971e-05;
0.003636,4.77787e-05;
0.003782,3.17096e-05;
0.003927,2.25986e-05;
0.004072,1.38773e-05;
0.004218,8.42419e-06;
0.004363,4.27655e-06;
0.004509,2.56935e-06;
0.004654,2.6042e-07;
];
omega = A(:,1);
E_model = A(:,2);
domega = omega(2);

L_GM = 1.3E3;       % [m]
invT_GM = 5.2E-3;   % [1/s]
E_GM = 6.3E-5;      % [unitless]
f0 = abs(corfreq(latitude)/3600);

E_GM_total = L_GM*L_GM*L_GM*invT_GM*invT_GM*E_GM;


B = (2/pi)*(f0./omega).*(1./sqrt(omega.*omega-f0*f0));
S_gm = real(L_GM*L_GM*L_GM*invT_GM*invT_GM*E_GM*B);

figure
plot(omega,E_model/domega), hold on
plot(omega,S_gm)
ylog
vlines(f0,'g--')
