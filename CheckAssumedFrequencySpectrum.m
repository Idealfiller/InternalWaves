A = [0.000000,2.35046;
0.000145,0.34992;
0.000291,0.517649;
0.000436,0.0588859;
0.000582,0.0356636;
0.000727,0.0202263;
0.000873,0.0278692;
0.001018,0.00625471;
0.001164,0.0212131;
0.001309,0.015811;
0.001454,0.00867226;
0.001600,0.0107592;
0.001745,0.00523338;
0.001891,0.00449791;
0.002036,0.00777818;
0.002182,0.00301376;
0.002327,0.00362818;
0.002473,0.0050452;
0.002618,0.00305917;
0.002763,0.00415055;
0.002909,0.0024;
0.003054,0.00279817;
0.003200,0.00183925;
0.003345,0.00251572;
0.003491,0.00151881;
0.003636,0.00209096;
0.003782,0.00114997;
0.003927,0.00166905;
0.004072,0.00118367;
0.004218,0.00117233;
0.004363,0.00110549;
0.004509,0.000758268;
0.004654,0.000983278;
0.004800,0.000540952;
];
omega = A(:,1);
E_model = A(:,2);
domega = omega(2);
latitude = 31;

L_GM = 1.3E3;       % [m]
invT_GM = 5.2E-3;   % [1/s]
E_GM = 6.3E-5;      % [unitless]
f0 = abs(corfreq(latitude)/3600);

E_GM_total = L_GM*L_GM*L_GM*invT_GM*invT_GM*E_GM;


B = (2/pi)*(f0./omega).*(1./sqrt(omega.*omega-f0*f0));
S_gm = real(L_GM*L_GM*L_GM*invT_GM*invT_GM*E_GM*B);

figure
plot(omega*3600/(2*pi),E_model/domega), hold on
plot(omega*3600/(2*pi),S_gm)
ylog
vlines(f0,'g--')
